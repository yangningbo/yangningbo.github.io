<!doctype html>
<html>
<head>
<title>全球主要交易市场行情及搬砖收益</title>

<script type="text/javascript">
var JsCommon={uon:"zuon",uname:"zuname",uid:"zuid",aid:"zaid",rid:"zrid",vip:"zvip",aname:"zaname",note:"znote",lan:"zlan",other:"zother",mainDomain:"https://www.zb.com",vipDomain:"https://vip.zb.com",p2pDomain:"https://p2p.zb.com",transDomain:"https://trans.zb.com",staticDomain:"https://s.zb.com"};
  try{
    var oldDomain=document.domain;
    var numm1=oldDomain.indexOf('zb.com');
    document.domain = oldDomain.substring(numm1,oldDomain.length)
  } catch(msg) {
    document.domain = 'zb.com';  
  }
</script>

<script type="text/javascript">
var GLOBAL             = {},
    VERSION            = GLOBAL['VERSION']           = '1512552748836',
    ZNAME              = GLOBAL['ZNAME']              = 'z',
    DOMAIN_BASE        = GLOBAL['DOMAIN_BASE']       = 'zb.com',
    DOMAIN_MAIN        = GLOBAL['DOMAIN_MAIN']       = 'https://www.zb.com',
    DOMAIN_VIP         = GLOBAL['DOMAIN_VIP']        = 'https://vip.zb.com',
    DOMAIN_STATIC      = GLOBAL['DOMAIN_STATIC']     = 'https://s.zb.com',
    DOMAIN_P2P         = GLOBAL['DOMAIN_P2P']        = 'https://p2p.zb.com',
    DOMAIN_TRANS       = GLOBAL['DOMAIN_TRANS']      = 'https://trans.zb.com',
    LANG               = GLOBAL['LANG']              = 'cn',
    UON                = GLOBAL['UON']               = 'zuon',
    UID                = GLOBAL['UID']               = 'zuid',
    AID                = GLOBAL['AID']               = 'zaid',
    RID                = GLOBAL['RID']               = 'zrid',
    VIP                = GLOBAL['VIP']               = 'zvip',
    UNAME              = GLOBAL['UNAME']             = 'zuname',
    ANAME              = GLOBAL['ANAME']             = 'zaname',
    NOTE               = GLOBAL['NOTE']              = 'znote';

</script>
<meta charset="utf-8">
<meta name="renderer" content="webkit">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta http-equiv="Cache-Control" content="no-siteapp">
<meta content="yes" name="apple-mobile-web-app-capable">
<meta content="yes" name="apple-touch-fullscreen">
<meta content="telephone=no" name="format-detection">
<meta content="black" name="apple-mobile-web-app-status-bar-style">
<meta name="author" content="ZB.COM">
<meta name="copyright"  content="Copyright &copy;ZB.COM 版权所有">
<meta name="revisit-after"  content="1 days">

<link rel="shortcut icon" href="https://s.zb.com/statics/img/favicon/favicon_red.ico?V1512552748836">
<link rel=stylesheet type=text/css href="https://s.zb.com/statics/css/cnbtc2014.css?V1512552748836" />
<link rel="stylesheet" href="https://s.zb.com/statics/css/v2/module.base.css?V1512552748836">
<link rel="stylesheet" href="https://s.zb.com/statics/css/v2/module.common.css?V1512552748836">
<script src="https://s.zb.com/statics/js/v2/module.base.js?V1512552748836" charset="UTF-8"></script>
<script src="https://s.zb.com/statics/js/v2/module.lang.js?V1512552748836" charset="UTF-8"></script>
<script src="https://s.zb.com/statics/js/v2/sea.js?V1512552748836" charset="UTF-8"></script>
<script src="https://s.zb.com/statics/js/v2/sea.config.js?V1512552748836" charset="UTF-8"></script>

<link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link href="//at.alicdn.com/t/font_j96emwpaovzehfr.css" rel="stylesheet">


<!--[if lt IE 9]>
  <script src="https://s.zb.com/statics/js/v2/html5shiv.min.js?V1512552748836" charset="UTF-8"></script>
  <script src="https://s.zb.com/statics/js/v2/respond.min.js?V1512552748836" charset="UTF-8"></script>
<![endif]-->
<script type="text/javascript" src="https://s.zb.com/statics/js/common/webcommon.js?V1512552748836" charset="UTF-8"></script>
<script src="https://s.zb.com/statics/js/v2/jquery.imgscroll.js" charset="UTF-8"></script>
<script type="text/javascript">
if(JuaBox.isMobile()){
    document.writeln("<style type=\"text/css\">");
    document.writeln(".container, .bk-nav.navbar, .bk-footer, .bk-body, .bg-login, .Jua-showTip {min-width: 980px !important;}  ");
    document.writeln("</style>");
}
</script>


<style>

</style>

</head>
<body>
<div class="bk-body">

<script type="text/javascript" src="https://s.zb.com/statics/js/common/note.js?V1512552748836" charset="UTF-8"></script>
<script type="text/javascript" src="https://s.zb.com/statics/js/u/sxb/sxb.js?V1512552748836" charset="UTF-8"></script>

<script>
    $(function(){


        $(".topmenuhover .titlelist a").on('mouseenter',function(){
            $(this).addClass("on").siblings("a").removeClass("on");
            $(this).parents(".topmenuhover").find("ul").eq($(this).index()).addClass("on").siblings("ul").removeClass("on");
        })

        $(".down-market-table .d-hd a").on('mouseenter',function(){
            $(this).addClass("on").siblings("a").removeClass("on");
            $(this).parents(".down-market-table").find("table").eq($(this).index()).addClass("on").siblings("table").removeClass("on");
        })


        $(".cnyonoff").on("click",function(){
            $(this).toggleClass("on");
            $(".nocny").toggleClass("on");
            $(".iscny").toggleClass("on");
        })

    })
</script>

  <div class="coincont container">
     <div class="coin-hd">
        <h3>全球主要交易市场行情</h3>
        <div class="list" id="mainList">
            <ul>


            </ul>
        </div>
     </div>

     <div class="coin-bd">
        <table class="mk-table">
            <thead>
                <tr>
                    <th style="padding-left:60px;">市场</th><th>最新成交价</th><th>24H最低价</th><th>24H最高价</th><th>24H成交量</th><th>幅度</th><th>对标ZB收益</th>
                </tr>
            </thead>
            <tbody id="mkList">
            </tbody>

        </table>

     </div>

  </div>

<!--页面中部内容结束-->
</div>

<script type="text/javascript">
seajs.use(["module_market","module_asset","module_common"],function(market,asset){
    market.init();
    asset.init();
});
</script>
<script type="text/javascript">
zb.vipDomain = "https://vip.zb.com";
zb.p2pDomain = "https://p2p.zb.com";
zb.transDomain = "https://trans.zb.com";
zb.staticDomain = "https://s.zb.com";
//百度统计1
var _hmt = _hmt || [];
setTimeout(function(){
    //仅在首页加载统计，延迟3秒执行
    if(top.location.pathname == '/'){
            var hm = document.createElement("script");
          hm.src = "//hm.baidu.com/hm.js?91482c4e5c7ba2e9a163a30955976db4";
          var s = document.getElementsByTagName("script")[0]; 
          s.parentNode.insertBefore(hm, s);
            //百度统计
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
        }
},3000)
</script>

<script>
$(function(){
    getAllPlatform();

    platform ();
    market();
    setTimeout(function(){

        //do something
        platform();
        setTimeout(arguments.callee,2000);
    },2000)
    setTimeout(function(){

        //do something
        market();
        setTimeout(arguments.callee,2000);
    },2000)
    setTimeout(function(){

        //do something
        getAllPlatform();
        setTimeout(arguments.callee,2000*30*60);
    },2000*30*60)
/*    setInterval("platform()",2000);
    setInterval("market()",2000);*/
});
var coin="btc";
var tickerPrice={};
var paltformPrice={};
var tickerRate={};
var paltformRate={};
var paltformsorts='';

var sorts=['qc','usdt','btc','ltc','eth','etc','bts','eos','bcc','qtum','hsr','xrp','bcd','dash']
function getAllPlatform() {
    $.ajax({
        type: "POST",
        url: "https://ticker.zb.com/getAllPlatform",
        data: {platform:"zb"},
        dataType: "jsonp",
        error: function () {
            // alert("error");
        },
        success: function (json) {
            if (json.isSuc) {
                paltformsorts=json.datas;
            }else{
                // alert("出错了，请稍后重试");
            }
        }
    });
}
function platform () {

    $.ajax({
        type: "POST",
        url: "https://ticker.zb.com/getTickersByPlatform",
        data: {platform:"zb"},
        dataType: "jsonp",
        error: function () {
           // alert("error");
        },
        success: function (json) {
            if (json.isSuc) {
                var html = "";
                tickerlastPrice();
                $("#mainList").empty();
                $("#mainList").append("<ul></ul>")
                var u = $("#mainList >ul");
                if(sorts==''){//不存在排序时
                    for (var i in json.datas) {
                            var data = json.datas[i];
                            var str=buildLi(data);
                            u.append(str);
                            $("#"+data.coin+"_li").bind('click',function(){
                                liOnclick($(this).attr("id"))
                            });
                    }
                }else {//存在排序的时候
                    for(var sort in sorts){
                        for (var i in json.datas) {
                                var data = json.datas[i];
                                if (data.coin == sorts[sort]) {
                                    var str = buildLi(data);
                                    u.append(str);
                                    $("#" + data.coin + "_li").bind('click', function () {
                                        liOnclick($(this).attr("id"))
                                    });
                                }
                        }
                    }
                }
               // $("#recordList").html(html);
                return false;
            }else{
               // alert("出错了，请稍后重试");
            }
        }
    });
}
function market() {
    $.ajax({
        type: "POST",
        url: "https://ticker.zb.com/getTickers",
        data: {coin:coin},
        dataType: "jsonp",
        error: function () {
            //alert("error");
        },
        success: function (json) {
            if (json.isSuc) {
                var html = "";
                paltformlastPrice();
                $("#mkList").empty();
                /*$("#mkList").append("<tr></tr>")*/
                var u = $("#mkList");

                var data0;
                for(var sort in paltformsorts){
                    for (var i in json.datas) {
                        var data = json.datas[i];
                        if(data != null) {
                            if (data.name.toLowerCase() == "zb") {
                                data0 = data;
                                break;
                            }
                        }
                    }
                }

                for(var sort in paltformsorts){
                    for (var i in json.datas) {
                        var data = json.datas[i];
                        if(data!=null) {
                            if (data.name.toLowerCase() == paltformsorts[sort]) {
                                var str = buildMarket(data0, data);
                                u.append(str);
                            }
                        }
                    }
                }
                /*for (var i in json.datas) {
                    var data = json.datas[i];
                        var str=buildMarket(data);
                        u.append(str);
                }*/
                // $("#recordList").html(html);
                return false;
            }else{
              //  alert("出错了，请稍后重试");
            }
        }
    });
}
function buildLi(data) {
    var str="";
    var riseRate="";
    var rate="";
    if(data.coin==coin){
        str=str+"<li class='on' id='"+data.coin+"_li'>";
    }else {
        str=str+"<li id='"+data.coin+"_li'>";
    }
    str=str+"<h4><b>"+data.coin.toUpperCase()+"</b></h4>"
    var key=data.coin;
    var lastprice=tickerPrice[key];
    if(lastprice!=""&&lastprice!=null){
        var price=lastprice;
        if(price<data.ticker.last){
            rate="up";
            tickerRate[key]=rate;
        }else  if(price==data.ticker.last){
            rate=tickerRate[key];
        } else {
            rate="down";
            tickerRate[key]=rate;
        }
    }
    if(data.ticker.riseRate.indexOf("-")){
        riseRate="up";
        rate=rate==""?"up":rate; tickerRate[key]=rate;
    }else {riseRate="down"; rate=rate==""?"down":rate;tickerRate[key]=rate;}
    /*var lastprice=$("#"+data.coin+"_price").text();
    lastprice=lastprice.substring(1,lastprice.length);*/

    str=str+"<div class='c-price "+rate+"'><span id='"+data.coin+"_price'>￥"+new Number(data.ticker.last)+"</span><i class='fa fa-arrow-"+rate+" fa-fw'></i><em>"+data.ticker.riseRate+"%</em></div></li>"
    return str;
}
function buildMarket(data0, data) {
    var str="";
    var rate="";
    var riseRate="";
    if(data==null){return ""}
    var key=data.name;
        // var price=$("#"+data.name+"_nowprice").text().split(" ")[1];
    var price = paltformPrice[key];
    if (price < data.ticker.last) {
        rate = "up";
        paltformRate[key] = rate;
    } else if (price == data.ticker.last) {
        rate = paltformRate[key] = rate;
    } else {
        rate = "down";
        paltformRate[key] = rate;
    }
    if(data.ticker.riseRate.indexOf("-")){
        riseRate="up";
        rate=rate==""?"up":rate;paltformRate[key]=rate;
    }else {riseRate="down";rate=rate==""?"down":rate;paltformRate[key]=rate;}
    if(data.name=='zb'){
        str=str+"<tr> <td><a class='mklogo "+data.name.toLowerCase()+"'></a><b class='marketname'>"+data.name.toUpperCase()+"</b></td>" +
            "<td><span id='"+data.name+"_nowprice' class='nowprice "+rate+"'>¥ "+new Number(data.ticker.lastRmb)+"<i class='fa fa-arrow-"+rate+" fa-fw'></i></span><em>$  "+new Number(data.ticker.dollar)+"</em></td>"+
            "<td><span class='day-low-price'>¥ "+new Number(data.ticker.lowRmb)+"</span><em>$  "+new Number(data.ticker.lowdollar)+"</em></td>"+
            "<td><span class='day-high-price'>¥ "+new Number(data.ticker.highRmb)+"</span><em>$  "+new Number(data.ticker.highdollar)+"</em></td>"+
            "<td><b class='dayvolume'>"+dayVolume(data.ticker.vol,data.name)+"</b></td> <td><b class='range "+riseRate+"'>"+data.ticker.riseRate+"%</b></td>"+
            "<td><b class='profit'>"+(new Number(data.ticker.last)*100/new Number(data0.ticker.last)-100).toFixed(2)+"%</b></td></tr>"
    }else {
        str=str+"<tr> <td><a class='mklogo "+data.name.toLowerCase()+"'></a><b class='marketname'>"+data.name.toUpperCase()+"</b></td>" +
            "<td><span id='"+data.name+"_nowprice' class='nowprice "+rate+"'>¥ "+new Number(data.ticker.last)+"<i class='fa fa-arrow-"+rate+" fa-fw'></i></span><em>$  "+new Number(data.ticker.dollar)+"</em></td>"+
            "<td><span class='day-low-price'>¥ "+new Number(data.ticker.low)+"</span><em>$  "+new Number(data.ticker.lowdollar)+"</em></td>"+
            "<td><span class='day-high-price'>¥ "+new Number(data.ticker.high)+"</span><em>$  "+new Number(data.ticker.highdollar)+"</em></td>"+
            "<td><b class='dayvolume'>"+dayVolume(data.ticker.vol,data.name)+"</b></td> <td><b class='range "+riseRate+"'>"+data.ticker.riseRate+"%</b></td>"+
            "<td><b class='profit'>"+(new Number(data.ticker.last)*100/new Number(data0.ticker.last)-100).toFixed(2)+"%</b></td></tr>"
    }
    return str;
}
function liOnclick(id) {
    coin=id.replace("_li","");
    $(".on").attr("class","");
    $("#"+coin+"_li").attr("class","on");
    market();
}
function paltformlastPrice() {
        for (var i in paltformsorts) {
            var price= $("#"+paltformsorts[i]+"_nowprice").text().split(" ")[1];
            var key=paltformsorts[i];
            paltformPrice[key]=price;
        }

}
function tickerlastPrice() {
        for (var i in sorts) {
            var price= $("#"+sorts[i]+"_price").text().substring(1,$("#"+sorts[i]+"_price").text().length);
            var key=sorts[i];
            tickerPrice[key]=price;
        }
}
function dayVolume(dayVolume,name) {
   // var M = require("module_method");
    var dayVolumeStr;
    if(LANG == 'cn'&&name!='zb'){
        dayVolumeStr = fixNumber(parseFloat(dayVolume)/10000, 2) + "万";
    }else{
        if(name=='zb'&&dayVolume>10000){
            dayVolumeStr = fixNumber(parseFloat(dayVolume)/10000, 2) + "万";
        }else {
            dayVolumeStr = divNumber(parseFloat(dayVolume),2);
        }

    }
    return dayVolumeStr;
}
fixNumber = function(value,unit){
    //此处不能使用toString方法转换字符串，超出7位小数将返回科学计数法的字符串
    var value =  isNaN(value) ? "0" : parseFloat(value).toFixed(8);
    var unit = unit || 0 ;
    var isInt = value.indexOf(".") == -1 ? true : false ;
    var intNum = value.split(".")[0];
    var floatNum = !isInt ? value.split(".")[1] : "0";
    var floatArry = floatNum.split("");
    var newFloatNum = ".";
    for(var i = 0; i < unit ; i++){
        if(!floatArry[i]){
            newFloatNum += "0" ;
        }else{
            newFloatNum += floatArry[i] ;
        }
    }
    return parseFloat(intNum +  newFloatNum).toFixed(unit);
};
divNumber = function(s, n) {
    n = n > 0 && n <= 20 ? n : 2;
    s = parseFloat((s + "").replace(/[^\d\.-]/g, "")).toFixed(n) + "";
    var l = s.split(".")[0].split("").reverse();
    r = s.split(".")[1];
    t = "";
    for(i = 0; i < l.length; i ++ ) {
        t += l[i] + ((i + 1) % 3 == 0 && (i + 1) != l.length ? "," : "");
    }
    return t.split("").reverse().join("") + "." + r;
}
</script>

</body>
</html>